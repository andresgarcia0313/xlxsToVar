<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convertir archivo de hojas de calculo a Objeto JavaScript</title>
</head>
<body>
    <label for="fileInput">Selecciona un archivo de hoja de calculo</label>
    <input type="file" id="fileInput" accept=".xlsx">
    <div id="output"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.4/xlsx.full.min.js"></script>
    <script>
        // Agregamos un evento change al input file
        document.getElementById('fileInput').addEventListener('change', function(event) {
            const file = event.target.files[0]; // Obtenemos el primer archivo seleccionado

            const reader = new FileReader(); // Creamos un objeto FileReader

            reader.onload = function(event) { // Función que se ejecuta cuando se carga el archivo
                const data = new Uint8Array(event.target.result); // Convertimos los datos a Uint8Array
                const workBook = XLSX.read(data, {type: 'array'}); // Leemos el archivo 
                const sheets = [];
                workBook.SheetNames.forEach(sheetName => {
                    const sheet = workBook.Sheets[sheetName];
                    sheets.push({
                        name: sheetName,
                        data: XLSX.utils.sheet_to_json(sheet)
                    });
                });
                // Mostramos los datos en la consola o donde desees
                console.log(sheets);
                // También podrías mostrarlos en el HTML
                const outputElement = document.getElementById('output');
                outputElement.innerHTML = ''; // Limpiamos el contenido previo
                sheets.forEach(sheet => {
                    const sheetElement = document.createElement('div');
                    sheetElement.innerHTML = `<h3>${sheet.name}</h3>`;
                    sheet.data.forEach(row => {
                        sheetElement.innerHTML += `<p>${JSON.stringify(row)}</p>`;
                    });
                    outputElement.appendChild(sheetElement);
                });
            };

            reader.readAsArrayBuffer(file); // Leemos el archivo como un ArrayBuffer
        });
    </script>
</body>
</html>
